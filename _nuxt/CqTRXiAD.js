import{p as P,u as $,b as B,m as I}from"./ChmvbhwP.js";import{u as C,g as L}from"./BVBr6DpG.js";import{q as M,s as O,v as c,x as V,y as j,i as q,o as n,b as o,F as D,r as H,z as T,e as z,A as b,m as U,f as G,t as J}from"./CdGePQmR.js";const K=["type","sizes","srcset"],Q=["src","sizes","srcset"],R=M({__name:"NuxtPicture",props:P,emits:["load","error"],setup(d,{emit:v}){const s=d,p=O(),i=v,_=!1,r=C(),{attrs:h,options:A,modifiers:k}=$(s),x=c(()=>L(s.src)),F=c(()=>["png","webp","gif","svg"].includes(x.value)),u=c(()=>s.legacyFormat?s.legacyFormat:F.value?"png":"jpeg"),m=c(()=>{var f,t;const e=((f=s.format)==null?void 0:f.split(","))||(x.value==="svg"?["svg"]:(t=r.options.format)!=null&&t.length?[...r.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(u.value)&&e.splice(e.indexOf(u.value),1),e.push(u.value),e.map(y=>{const{srcset:w,sizes:S,src:N}=r.getSizes(s.src,{...A.value,sizes:s.sizes||r.options.screens,densities:s.densities,modifiers:{...k.value,format:y}});return{src:N,type:`image/${y}`,sizes:S,srcset:w}}))}),l=c(()=>m.value[m.value.length-1]),g={...s.imgAttrs,"data-nuxt-pic":""};for(const e in p)e in B&&!(e in g)&&(g[e]=p[e]);const a=V(),E=j().isHydrating;return q(()=>{a.value&&(a.value.complete&&E&&(a.value.getAttribute("data-error")?i("error",new Event("error")):i("load",new Event("load"))),a.value.onload=e=>{i("load",e)},a.value.onerror=e=>{i("error",e)},I("nuxt-picture"))}),(e,f)=>(n(),o("picture",null,[(n(!0),o(D,null,H(m.value.slice(0,-1),t=>(n(),o("source",{key:t.src,type:t.type,sizes:t.sizes,srcset:t.srcset},null,8,K))),128)),l.value?(n(),o("img",T({key:0,ref_key:"imgEl",ref:a},{...z(h),...z(_)?{onerror:"this.setAttribute('data-error', 1)"}:{},...g},{src:l.value.src,sizes:l.value.sizes,srcset:l.value.srcset}),null,16,Q)):b("",!0)]))}}),W={props:["title","image","alt"]},X={key:0,class:"caption"};function Y(d,v,s,p,i,_){const r=R;return n(),o("figure",null,[G(r,{src:s.image,alt:s.alt,format:"webp",sizes:"600px md:800px lg:1000px",densities:"x1 x2"},null,8,["src","alt"]),s.title?(n(),o("figcaption",X,J(s.title),1)):b("",!0)])}const re=U(W,[["render",Y]]);export{re as default};
